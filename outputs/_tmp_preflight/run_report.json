{
  "meta": {
    "timestamp": "2025-12-27T17:27:04",
    "run_dir": "outputs/_tmp_preflight",
    "host": "Enhuis-Mac-Studio.local",
    "git_commit": "a84b364b797739f6a6669e4a8308245a452d798f"
  },
  "config": {
    "resolved": {
      "seed": 0,
      "outer_iters": 5,
      "trajectories": 2,
      "horizon": 50,
      "gamma": 0.95,
      "alpha_w": 0.1,
      "alpha_pi": 0.05,
      "beta": 0.2,
      "sigma_mu": 0.3,
      "sigma_pi": 0.2,
      "K_mc": 2,
      "theta_radius": 5.0,
      "theta_init_scale": 0.1,
      "w_init_scale": 0.1,
      "checkpoint_every": 1,
      "log_every": 1,
      "report_every": 1,
      "report_every_seconds": 0,
      "output_dir": "outputs/_tmp_preflight",
      "resume": false,
      "resume_from": null,
      "env_config_path": "configs/default.yaml",
      "env": {
        "feature_dim": 256,
        "actor_feature_dim": 64,
        "p_mix": 0.1
      },
      "probes": {
        "enabled": true,
        "every": 1,
        "plateau": {
          "enabled": false,
          "window": 5,
          "tol": 0.001,
          "cooldown": 5,
          "min_iter": 5
        },
        "fixed_point": {
          "enabled": true,
          "batch_size": 512,
          "max_iters": 200,
          "tol": 1e-06,
          "k_mc": 2
        },
        "stability": {
          "enabled": true,
          "batch_size": 512,
          "power_iters": 20,
          "k_mc": 2,
          "n_power_iters": 20
        },
        "distribution": {
          "enabled": true,
          "num_samples": 512
        }
      }
    },
    "key_hparams": {
      "seed": 0,
      "outer_iters": 5,
      "horizon": 50,
      "gamma": 0.95,
      "alpha_w": 0.1,
      "alpha_pi": 0.05,
      "beta": 0.2,
      "sigma_pi": 0.2,
      "sigma_mu": 0.3,
      "feature_dim": 256,
      "p_mix": 0.1,
      "check_name": null
    }
  },
  "files": {
    "learning_curves_path": "outputs/_tmp_preflight/learning_curves.csv",
    "probes_paths": [
      "outputs/_tmp_preflight/probes/distribution_probe.csv",
      "outputs/_tmp_preflight/probes/fixed_point_probe.csv",
      "outputs/_tmp_preflight/probes/stability_probe.csv"
    ],
    "stdout_log_path": null,
    "checkpoint_dir": "outputs/_tmp_preflight/checkpoints"
  },
  "health_checks": {
    "no_nan_inf": {
      "pass": true,
      "reason": "all core columns finite",
      "observed": {
        "nan_count": 0,
        "inf_count": 0,
        "nan_cols": [],
        "inf_cols": [],
        "core_cols": [
          "critic_teacher_error",
          "mean_rho2",
          "td_loss",
          "tracking_gap",
          "w_norm"
        ]
      },
      "applicable": true
    },
    "probe_missing_values": {
      "pass": true,
      "reason": "all probe columns finite",
      "observed": {
        "nan_count": 0,
        "inf_count": 0,
        "missing_count": 0,
        "nan_cols": [],
        "inf_cols": [],
        "probe_cols": [
          "dist_mean_l2",
          "dist_mmd2",
          "fixed_point_drift",
          "fixed_point_drift_defined",
          "fixed_point_gap",
          "stability_proxy"
        ],
        "probes_enabled": true,
        "probes_every": 1,
        "strict_mode": true
      },
      "applicable": true
    },
    "monotone_time": {
      "pass": true,
      "reason": "time is strictly increasing",
      "observed": {
        "time_col": "iter",
        "first_violation_index": null
      },
      "applicable": true
    },
    "rho_sane": {
      "pass": true,
      "reason": "rho within threshold",
      "observed": {
        "rho_column": "mean_rho2",
        "max": 1.77998782662024,
        "threshold": 1000.0
      },
      "applicable": true
    },
    "on_policy_expected": {
      "pass": true,
      "reason": "not applicable",
      "observed": {
        "mean_rho2": 1.4799988696921667,
        "dist_mmd2": 0.01805473992992601
      },
      "applicable": false
    },
    "no_bootstrap_expected": {
      "pass": true,
      "reason": "not applicable",
      "observed": {
        "gamma": 0.95
      },
      "applicable": false
    },
    "fixed_pi_expected": {
      "pass": true,
      "reason": "not applicable",
      "observed": {
        "alpha_pi": 0.05
      },
      "applicable": false
    }
  },
  "summary_metrics": {
    "learning_curves": {
      "td_loss": {
        "last": 0.00015153025060005368,
        "min": 3.9874858102734524e-05,
        "max": 0.00015153025060005368,
        "mean_last_k": 8.688190200125407e-05,
        "slope_last_k": 1.7723300154010946e-05
      },
      "w_norm": {
        "last": 1.5482396713832387,
        "min": 1.5482396713832387,
        "max": 1.5482714919684342,
        "mean_last_k": 1.548259067811069,
        "slope_last_k": -7.5609109629004575e-06
      },
      "mean_rho2": {
        "last": 1.4799988696921667,
        "min": 1.4294693439412458,
        "max": 1.77998782662024,
        "mean_last_k": 1.6069344816346767,
        "slope_last_k": -0.04446038033465225
      },
      "tracking_gap": {
        "last": 7.945832307083368e-11,
        "min": 1.0435084527070561e-11,
        "max": 7.945832307083368e-11,
        "mean_last_k": 4.792825230296538e-11,
        "slope_last_k": 1.4224200142881305e-11
      },
      "critic_teacher_error": {
        "last": 0.022380879557405173,
        "min": 0.022380879557405173,
        "max": 0.02238589076269836,
        "mean_last_k": 0.022383612011248864,
        "slope_last_k": -1.1860073436856245e-06
      }
    },
    "probes": {
      "distribution_probe": {
        "iter": {
          "last": 4.0,
          "min": 0.0,
          "max": 4.0,
          "mean_last_k": 2.0,
          "slope_last_k": 1.0
        },
        "mean_l2": {
          "last": 0.3204918767249825,
          "min": 0.3204918767249825,
          "max": 0.7840523726976157,
          "mean_last_k": 0.5959210143439259,
          "slope_last_k": -0.10729990267144578
        },
        "mmd2": {
          "last": 0.01805473992992601,
          "min": 0.01805473992992601,
          "max": 0.05278551805258269,
          "mean_last_k": 0.03721235118587711,
          "slope_last_k": -0.008140554319300752
        },
        "mmd_sigma": {
          "last": 2.3709455052775925,
          "min": 2.3541578557951492,
          "max": 2.3709455052775925,
          "mean_last_k": 2.358885504535409,
          "slope_last_k": 0.003409878521494347
        },
        "num_samples": {
          "last": 512.0,
          "min": 512.0,
          "max": 512.0,
          "mean_last_k": 512.0,
          "slope_last_k": 0.0
        }
      },
      "fixed_point_probe": {
        "batch_size": {
          "last": 512.0,
          "min": 512.0,
          "max": 512.0,
          "mean_last_k": 512.0,
          "slope_last_k": 0.0
        },
        "iter": {
          "last": 4.0,
          "min": 0.0,
          "max": 4.0,
          "mean_last_k": 2.0,
          "slope_last_k": 1.0
        },
        "num_iters": {
          "last": 200.0,
          "min": 200.0,
          "max": 200.0,
          "mean_last_k": 200.0,
          "slope_last_k": 0.0
        },
        "tol": {
          "last": 1e-06,
          "min": 1e-06,
          "max": 1e-06,
          "mean_last_k": 1e-06,
          "slope_last_k": 0.0
        },
        "w_gap": {
          "last": 0.02160970248269506,
          "min": 0.01602360681152295,
          "max": 0.026809323500101696,
          "mean_last_k": 0.02207136585756096,
          "slope_last_k": -0.0012641882769096721
        },
        "w_sharp_drift": {
          "last": 0.017212815664483072,
          "min": 0.0,
          "max": 0.021203695180748317,
          "mean_last_k": 0.015206500378825608,
          "slope_last_k": 0.0032408770632725223
        },
        "w_sharp_drift_defined": {
          "last": 1.0,
          "min": 0.0,
          "max": 1.0,
          "mean_last_k": 0.8,
          "slope_last_k": 0.2
        }
      },
      "stability_probe": {
        "batch_size": {
          "last": 512.0,
          "min": 512.0,
          "max": 512.0,
          "mean_last_k": 512.0,
          "slope_last_k": 0.0
        },
        "iter": {
          "last": 4.0,
          "min": 0.0,
          "max": 4.0,
          "mean_last_k": 2.0,
          "slope_last_k": 1.0
        },
        "power_iters": {
          "last": 20.0,
          "min": 20.0,
          "max": 20.0,
          "mean_last_k": 20.0,
          "slope_last_k": 0.0
        },
        "stability_proxy": {
          "last": 0.9999917340651693,
          "min": 0.9999895647257389,
          "max": 0.9999917340651693,
          "mean_last_k": 0.9999909443108773,
          "slope_last_k": 1.9338975766336474e-07
        }
      }
    }
  },
  "samples": {
    "head_rows": [
      {
        "iter": 0.0,
        "td_loss": 3.9874858102734524e-05,
        "critic_teacher_error": 0.02238589076269836,
        "tracking_gap": 1.0435084527070561e-11,
        "mean_rho2": 1.77998782662024,
        "w_norm": 1.5482714919684342,
        "fixed_point_gap": 0.024988720242623413,
        "fixed_point_drift": 0.0,
        "fixed_point_drift_defined": 0.0,
        "stability_proxy": 0.9999913415722261,
        "dist_mmd2": 0.05278551805258269,
        "dist_mean_l2": 0.7840523726976157
      },
      {
        "iter": 1.0,
        "td_loss": 0.00010232496298692331,
        "critic_teacher_error": 0.022384662166282095,
        "tracking_gap": 4.1057419508854366e-11,
        "mean_rho2": 1.4294693439412458,
        "w_norm": 1.548266876531246,
        "fixed_point_gap": 0.026809323500101696,
        "fixed_point_drift": 0.019816425872568783,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999904661397808,
        "dist_mmd2": 0.04284733221403125,
        "dist_mean_l2": 0.6684170891378501
      },
      {
        "iter": 2.0,
        "td_loss": 8.443225878416434e-05,
        "critic_teacher_error": 0.022383803066427066,
        "tracking_gap": 6.343749055792713e-11,
        "mean_rho2": 1.7603729134688615,
        "w_norm": 1.5482623905804176,
        "fixed_point_gap": 0.01602360681152295,
        "fixed_point_drift": 0.021203695180748317,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999895647257389,
        "dist_mmd2": 0.04147082046650852,
        "dist_mean_l2": 0.6841046787905218
      },
      {
        "iter": 3.0,
        "td_loss": 5.624717953239446e-05,
        "critic_teacher_error": 0.022382824503431615,
        "tracking_gap": 4.525294385014115e-11,
        "mean_rho2": 1.58484345445087,
        "w_norm": 1.5482549085920079,
        "fixed_point_gap": 0.020925476250861684,
        "fixed_point_drift": 0.017799565176327865,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999916150514712,
        "dist_mmd2": 0.03090334526633709,
        "dist_mean_l2": 0.5225390543686588
      },
      {
        "iter": 4.0,
        "td_loss": 0.00015153025060005368,
        "critic_teacher_error": 0.022380879557405173,
        "tracking_gap": 7.945832307083368e-11,
        "mean_rho2": 1.4799988696921667,
        "w_norm": 1.5482396713832387,
        "fixed_point_gap": 0.02160970248269506,
        "fixed_point_drift": 0.017212815664483072,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999917340651693,
        "dist_mmd2": 0.01805473992992601,
        "dist_mean_l2": 0.3204918767249825
      }
    ],
    "tail_rows": [
      {
        "iter": 0.0,
        "td_loss": 3.9874858102734524e-05,
        "critic_teacher_error": 0.02238589076269836,
        "tracking_gap": 1.0435084527070561e-11,
        "mean_rho2": 1.77998782662024,
        "w_norm": 1.5482714919684342,
        "fixed_point_gap": 0.024988720242623413,
        "fixed_point_drift": 0.0,
        "fixed_point_drift_defined": 0.0,
        "stability_proxy": 0.9999913415722261,
        "dist_mmd2": 0.05278551805258269,
        "dist_mean_l2": 0.7840523726976157
      },
      {
        "iter": 1.0,
        "td_loss": 0.00010232496298692331,
        "critic_teacher_error": 0.022384662166282095,
        "tracking_gap": 4.1057419508854366e-11,
        "mean_rho2": 1.4294693439412458,
        "w_norm": 1.548266876531246,
        "fixed_point_gap": 0.026809323500101696,
        "fixed_point_drift": 0.019816425872568783,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999904661397808,
        "dist_mmd2": 0.04284733221403125,
        "dist_mean_l2": 0.6684170891378501
      },
      {
        "iter": 2.0,
        "td_loss": 8.443225878416434e-05,
        "critic_teacher_error": 0.022383803066427066,
        "tracking_gap": 6.343749055792713e-11,
        "mean_rho2": 1.7603729134688615,
        "w_norm": 1.5482623905804176,
        "fixed_point_gap": 0.01602360681152295,
        "fixed_point_drift": 0.021203695180748317,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999895647257389,
        "dist_mmd2": 0.04147082046650852,
        "dist_mean_l2": 0.6841046787905218
      },
      {
        "iter": 3.0,
        "td_loss": 5.624717953239446e-05,
        "critic_teacher_error": 0.022382824503431615,
        "tracking_gap": 4.525294385014115e-11,
        "mean_rho2": 1.58484345445087,
        "w_norm": 1.5482549085920079,
        "fixed_point_gap": 0.020925476250861684,
        "fixed_point_drift": 0.017799565176327865,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999916150514712,
        "dist_mmd2": 0.03090334526633709,
        "dist_mean_l2": 0.5225390543686588
      },
      {
        "iter": 4.0,
        "td_loss": 0.00015153025060005368,
        "critic_teacher_error": 0.022380879557405173,
        "tracking_gap": 7.945832307083368e-11,
        "mean_rho2": 1.4799988696921667,
        "w_norm": 1.5482396713832387,
        "fixed_point_gap": 0.02160970248269506,
        "fixed_point_drift": 0.017212815664483072,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999917340651693,
        "dist_mmd2": 0.01805473992992601,
        "dist_mean_l2": 0.3204918767249825
      }
    ]
  },
  "health_summary": {
    "status": "PASS",
    "reasons": [
      "all checks passed"
    ]
  },
  "recommendations": [
    "no major rule-based issues detected; consider longer runs or new probes if results are inconclusive."
  ],
  "incomplete": false,
  "exception": null
}