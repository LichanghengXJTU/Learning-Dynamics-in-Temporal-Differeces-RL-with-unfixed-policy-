{
  "meta": {
    "timestamp": "2025-12-27T18:15:52",
    "run_dir": "/Users/enhuili/Desktop/Learning Dynamics in Temporal Differences Reinforcement Learning with Unfixed Policy/Learning-Dynamics-in-Temporal-Differeces-RL-with-unfixed-policy-/outputs/sanity_suite/20251227_181544/full_triad_short",
    "host": "Enhuis-Mac-Studio.local",
    "git_commit": "a84b364b797739f6a6669e4a8308245a452d798f"
  },
  "config": {
    "resolved": {
      "K_mc": 2,
      "alpha_pi": 0.05,
      "alpha_w": 0.1,
      "beta": 0.2,
      "check_name": "full_triad_short",
      "checkpoint_every": 1,
      "env": {
        "actor_feature_dim": 64,
        "feature_dim": 256,
        "p_mix": 0.1
      },
      "env_config_path": "/Users/enhuili/Desktop/Learning Dynamics in Temporal Differences Reinforcement Learning with Unfixed Policy/Learning-Dynamics-in-Temporal-Differeces-RL-with-unfixed-policy-/configs/default.yaml",
      "gamma": 0.95,
      "horizon": 50,
      "log_every": 1,
      "outer_iters": 8,
      "output_dir": "/Users/enhuili/Desktop/Learning Dynamics in Temporal Differences Reinforcement Learning with Unfixed Policy/Learning-Dynamics-in-Temporal-Differeces-RL-with-unfixed-policy-/outputs/sanity_suite/20251227_181544/full_triad_short",
      "probes": {
        "distribution": {
          "enabled": true,
          "num_samples": 512
        },
        "enabled": true,
        "every": 1,
        "fixed_point": {
          "batch_size": 512,
          "enabled": true,
          "k_mc": 2,
          "max_iters": 200,
          "tol": "1e-6"
        },
        "plateau": {
          "cooldown": 5,
          "enabled": false,
          "min_iter": 5,
          "tol": 0.001,
          "window": 5
        },
        "stability": {
          "batch_size": 512,
          "enabled": true,
          "k_mc": 2,
          "n_power_iters": 20,
          "power_iters": 20
        }
      },
      "report_every": 0,
      "report_every_seconds": 0,
      "resume": false,
      "resume_from": null,
      "seed": 0,
      "sigma_mu": 0.3,
      "sigma_pi": 0.2,
      "theta_init_scale": 0.1,
      "theta_radius": 5.0,
      "trajectories": 2,
      "w_init_scale": 0.1
    },
    "key_hparams": {
      "seed": 0,
      "outer_iters": 8,
      "horizon": 50,
      "gamma": 0.95,
      "alpha_w": 0.1,
      "alpha_pi": 0.05,
      "beta": 0.2,
      "sigma_pi": 0.2,
      "sigma_mu": 0.3,
      "feature_dim": 256,
      "p_mix": 0.1,
      "check_name": "full_triad_short"
    }
  },
  "files": {
    "learning_curves_path": "/Users/enhuili/Desktop/Learning Dynamics in Temporal Differences Reinforcement Learning with Unfixed Policy/Learning-Dynamics-in-Temporal-Differeces-RL-with-unfixed-policy-/outputs/sanity_suite/20251227_181544/full_triad_short/learning_curves.csv",
    "probes_paths": [
      "/Users/enhuili/Desktop/Learning Dynamics in Temporal Differences Reinforcement Learning with Unfixed Policy/Learning-Dynamics-in-Temporal-Differeces-RL-with-unfixed-policy-/outputs/sanity_suite/20251227_181544/full_triad_short/probes/distribution_probe.csv",
      "/Users/enhuili/Desktop/Learning Dynamics in Temporal Differences Reinforcement Learning with Unfixed Policy/Learning-Dynamics-in-Temporal-Differeces-RL-with-unfixed-policy-/outputs/sanity_suite/20251227_181544/full_triad_short/probes/fixed_point_probe.csv",
      "/Users/enhuili/Desktop/Learning Dynamics in Temporal Differences Reinforcement Learning with Unfixed Policy/Learning-Dynamics-in-Temporal-Differeces-RL-with-unfixed-policy-/outputs/sanity_suite/20251227_181544/full_triad_short/probes/stability_probe.csv"
    ],
    "stdout_log_path": "/Users/enhuili/Desktop/Learning Dynamics in Temporal Differences Reinforcement Learning with Unfixed Policy/Learning-Dynamics-in-Temporal-Differeces-RL-with-unfixed-policy-/outputs/sanity_suite/20251227_181544/full_triad_short/stdout.log",
    "checkpoint_dir": "/Users/enhuili/Desktop/Learning Dynamics in Temporal Differences Reinforcement Learning with Unfixed Policy/Learning-Dynamics-in-Temporal-Differeces-RL-with-unfixed-policy-/outputs/sanity_suite/20251227_181544/full_triad_short/checkpoints"
  },
  "health_checks": {
    "no_nan_inf": {
      "pass": true,
      "reason": "all core columns finite",
      "observed": {
        "nan_count": 0,
        "inf_count": 0,
        "nan_cols": [],
        "inf_cols": [],
        "core_cols": [
          "critic_teacher_error",
          "mean_rho2",
          "td_loss",
          "tracking_gap",
          "w_norm"
        ]
      },
      "applicable": true
    },
    "probe_missing_values": {
      "pass": true,
      "reason": "all probe columns finite",
      "observed": {
        "nan_count": 0,
        "inf_count": 0,
        "missing_count": 0,
        "nan_cols": [],
        "inf_cols": [],
        "probe_cols": [
          "dist_mean_l2",
          "dist_mmd2",
          "fixed_point_drift",
          "fixed_point_drift_defined",
          "fixed_point_gap",
          "stability_proxy"
        ],
        "probes_enabled": true,
        "probes_every": 1,
        "strict_mode": true
      },
      "applicable": true
    },
    "monotone_time": {
      "pass": true,
      "reason": "time is strictly increasing",
      "observed": {
        "time_col": "iter",
        "first_violation_index": null
      },
      "applicable": true
    },
    "rho_sane": {
      "pass": true,
      "reason": "rho within threshold",
      "observed": {
        "rho_column": "mean_rho2",
        "max": 1.77998782662024,
        "threshold": 1000.0
      },
      "applicable": true
    },
    "on_policy_expected": {
      "pass": true,
      "reason": "not applicable",
      "observed": {
        "mean_rho2": 1.6703710201030901,
        "tracking_gap": 6.381568606009765e-11,
        "dist_mmd2": 0.03615768433471522,
        "threshold": 0.0783317,
        "num_samples": 512.0,
        "mmd_sigma": 2.34579931122884
      },
      "applicable": false
    },
    "no_bootstrap_expected": {
      "pass": true,
      "reason": "not applicable",
      "observed": {
        "gamma": 0.95
      },
      "applicable": false
    },
    "fixed_pi_expected": {
      "pass": true,
      "reason": "not applicable",
      "observed": {
        "alpha_pi": 0.05
      },
      "applicable": false
    }
  },
  "summary_metrics": {
    "learning_curves": {
      "td_loss": {
        "last": 8.23466270435367e-05,
        "min": 2.703796555427019e-05,
        "max": 0.00015153025060005368,
        "mean_last_k": 7.431338471757642e-05,
        "slope_last_k": -4.492645472014217e-06
      },
      "w_norm": {
        "last": 1.5482158794631429,
        "min": 1.5482151035866738,
        "max": 1.5482714919684342,
        "mean_last_k": 1.5482308017968716,
        "slope_last_k": -1.0262605429489646e-05
      },
      "mean_rho2": {
        "last": 1.6703710201030901,
        "min": 1.4294693439412458,
        "max": 1.77998782662024,
        "mean_last_k": 1.5707889251681695,
        "slope_last_k": 0.02723528977913321
      },
      "tracking_gap": {
        "last": 6.381568606009765e-11,
        "min": 1.0435084527070561e-11,
        "max": 7.945832307083368e-11,
        "mean_last_k": 5.872305891335344e-11,
        "slope_last_k": 9.028724046894782e-13
      },
      "critic_teacher_error": {
        "last": 0.022377953431216045,
        "min": 0.022377953431216045,
        "max": 0.02238589076269836,
        "mean_last_k": 0.022380295644126413,
        "slope_last_k": -1.1344497486253519e-06
      }
    },
    "probes": {
      "distribution_probe": {
        "iter": {
          "last": 7.0,
          "min": 0.0,
          "max": 7.0,
          "mean_last_k": 5.0,
          "slope_last_k": 1.0
        },
        "mean_l2": {
          "last": 0.636098673202821,
          "min": 0.3204918767249825,
          "max": 0.7840523726976157,
          "mean_last_k": 0.4698256493440727,
          "slope_last_k": 0.040295303801271685
        },
        "mmd2": {
          "last": 0.03615768433471522,
          "min": 0.01805473992992601,
          "max": 0.05278551805258269,
          "mean_last_k": 0.027423054150853977,
          "slope_last_k": 0.002013004075597813
        },
        "mmd_sigma": {
          "last": 2.34579931122884,
          "min": 2.3452983987823397,
          "max": 2.3709455052775925,
          "mean_last_k": 2.3539198693825747,
          "slope_last_k": -0.0036948224983515132
        },
        "num_samples": {
          "last": 512.0,
          "min": 512.0,
          "max": 512.0,
          "mean_last_k": 512.0,
          "slope_last_k": 0.0
        }
      },
      "fixed_point_probe": {
        "batch_size": {
          "last": 512.0,
          "min": 512.0,
          "max": 512.0,
          "mean_last_k": 512.0,
          "slope_last_k": 0.0
        },
        "iter": {
          "last": 7.0,
          "min": 0.0,
          "max": 7.0,
          "mean_last_k": 5.0,
          "slope_last_k": 1.0
        },
        "num_iters": {
          "last": 200.0,
          "min": 200.0,
          "max": 200.0,
          "mean_last_k": 200.0,
          "slope_last_k": 0.0
        },
        "tol": {
          "last": 1e-06,
          "min": 1e-06,
          "max": 1e-06,
          "mean_last_k": 1e-06,
          "slope_last_k": 0.0
        },
        "w_gap": {
          "last": 0.029224662734367277,
          "min": 0.01602360681152295,
          "max": 0.029224662734367277,
          "mean_last_k": 0.02272780269488018,
          "slope_last_k": 0.0018294712684166227
        },
        "w_sharp_drift": {
          "last": 0.02569435520355139,
          "min": 0.0,
          "max": 0.02569435520355139,
          "mean_last_k": 0.019507067168467607,
          "slope_last_k": 0.0017442954044994154
        },
        "w_sharp_drift_defined": {
          "last": 1.0,
          "min": 0.0,
          "max": 1.0,
          "mean_last_k": 1.0,
          "slope_last_k": 0.0
        }
      },
      "stability_probe": {
        "batch_size": {
          "last": 512.0,
          "min": 512.0,
          "max": 512.0,
          "mean_last_k": 512.0,
          "slope_last_k": 0.0
        },
        "iter": {
          "last": 7.0,
          "min": 0.0,
          "max": 7.0,
          "mean_last_k": 5.0,
          "slope_last_k": 1.0
        },
        "power_iters": {
          "last": 20.0,
          "min": 20.0,
          "max": 20.0,
          "mean_last_k": 20.0,
          "slope_last_k": 0.0
        },
        "stability_proxy": {
          "last": 0.9999917568193094,
          "min": 0.9999895647257389,
          "max": 0.9999923076586249,
          "mean_last_k": 0.9999919056342584,
          "slope_last_k": 8.571291321146646e-08
        }
      }
    }
  },
  "samples": {
    "head_rows": [
      {
        "iter": 0.0,
        "td_loss": 3.9874858102734524e-05,
        "critic_teacher_error": 0.02238589076269836,
        "tracking_gap": 1.0435084527070561e-11,
        "mean_rho2": 1.77998782662024,
        "w_norm": 1.5482714919684342,
        "fixed_point_gap": 0.024988720242623413,
        "fixed_point_drift": 0.0,
        "fixed_point_drift_defined": 0.0,
        "stability_proxy": 0.9999913415722261,
        "dist_mmd2": 0.05278551805258269,
        "dist_mean_l2": 0.7840523726976157
      },
      {
        "iter": 1.0,
        "td_loss": 0.00010232496298692331,
        "critic_teacher_error": 0.022384662166282095,
        "tracking_gap": 4.1057419508854366e-11,
        "mean_rho2": 1.4294693439412458,
        "w_norm": 1.548266876531246,
        "fixed_point_gap": 0.026809323500101696,
        "fixed_point_drift": 0.019816425872568783,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999904661397808,
        "dist_mmd2": 0.04284733221403125,
        "dist_mean_l2": 0.6684170891378501
      },
      {
        "iter": 2.0,
        "td_loss": 8.443225878416434e-05,
        "critic_teacher_error": 0.022383803066427066,
        "tracking_gap": 6.343749055792713e-11,
        "mean_rho2": 1.7603729134688615,
        "w_norm": 1.5482623905804176,
        "fixed_point_gap": 0.01602360681152295,
        "fixed_point_drift": 0.021203695180748317,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999895647257389,
        "dist_mmd2": 0.04147082046650852,
        "dist_mean_l2": 0.6841046787905218
      },
      {
        "iter": 3.0,
        "td_loss": 5.624717953239446e-05,
        "critic_teacher_error": 0.022382824503431615,
        "tracking_gap": 4.525294385014115e-11,
        "mean_rho2": 1.58484345445087,
        "w_norm": 1.5482549085920079,
        "fixed_point_gap": 0.020925476250861684,
        "fixed_point_drift": 0.017799565176327865,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999916150514712,
        "dist_mmd2": 0.03090334526633709,
        "dist_mean_l2": 0.5225390543686588
      },
      {
        "iter": 4.0,
        "td_loss": 0.00015153025060005368,
        "critic_teacher_error": 0.022380879557405173,
        "tracking_gap": 7.945832307083368e-11,
        "mean_rho2": 1.4799988696921667,
        "w_norm": 1.5482396713832387,
        "fixed_point_gap": 0.02160970248269506,
        "fixed_point_drift": 0.017212815664483072,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999917340651693,
        "dist_mmd2": 0.01805473992992601,
        "dist_mean_l2": 0.3204918767249825
      },
      {
        "iter": 5.0,
        "td_loss": 2.703796555427019e-05,
        "critic_teacher_error": 0.02238054352422918,
        "tracking_gap": 5.3726778887879306e-11,
        "mean_rho2": 1.5374346454156613,
        "w_norm": 1.548228445959295,
        "fixed_point_gap": 0.018573129806626783,
        "fixed_point_drift": 0.017962410142945532,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999921145767171,
        "dist_mmd2": 0.02432339867414368,
        "dist_mean_l2": 0.3736729653545262
      },
      {
        "iter": 6.0,
        "td_loss": 5.4404900857627044e-05,
        "critic_teacher_error": 0.02237927720435006,
        "tracking_gap": 5.136156269781545e-11,
        "mean_rho2": 1.5812966361790586,
        "w_norm": 1.5482151035866738,
        "fixed_point_gap": 0.0233060421998501,
        "fixed_point_drift": 0.018866189655030178,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999923076586249,
        "dist_mmd2": 0.027676102549147874,
        "dist_mean_l2": 0.49632567706937497
      },
      {
        "iter": 7.0,
        "td_loss": 8.23466270435367e-05,
        "critic_teacher_error": 0.022377953431216045,
        "tracking_gap": 6.381568606009765e-11,
        "mean_rho2": 1.6703710201030901,
        "w_norm": 1.5482158794631429,
        "fixed_point_gap": 0.029224662734367277,
        "fixed_point_drift": 0.02569435520355139,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999917568193094,
        "dist_mmd2": 0.03615768433471522,
        "dist_mean_l2": 0.636098673202821
      }
    ],
    "tail_rows": [
      {
        "iter": 0.0,
        "td_loss": 3.9874858102734524e-05,
        "critic_teacher_error": 0.02238589076269836,
        "tracking_gap": 1.0435084527070561e-11,
        "mean_rho2": 1.77998782662024,
        "w_norm": 1.5482714919684342,
        "fixed_point_gap": 0.024988720242623413,
        "fixed_point_drift": 0.0,
        "fixed_point_drift_defined": 0.0,
        "stability_proxy": 0.9999913415722261,
        "dist_mmd2": 0.05278551805258269,
        "dist_mean_l2": 0.7840523726976157
      },
      {
        "iter": 1.0,
        "td_loss": 0.00010232496298692331,
        "critic_teacher_error": 0.022384662166282095,
        "tracking_gap": 4.1057419508854366e-11,
        "mean_rho2": 1.4294693439412458,
        "w_norm": 1.548266876531246,
        "fixed_point_gap": 0.026809323500101696,
        "fixed_point_drift": 0.019816425872568783,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999904661397808,
        "dist_mmd2": 0.04284733221403125,
        "dist_mean_l2": 0.6684170891378501
      },
      {
        "iter": 2.0,
        "td_loss": 8.443225878416434e-05,
        "critic_teacher_error": 0.022383803066427066,
        "tracking_gap": 6.343749055792713e-11,
        "mean_rho2": 1.7603729134688615,
        "w_norm": 1.5482623905804176,
        "fixed_point_gap": 0.01602360681152295,
        "fixed_point_drift": 0.021203695180748317,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999895647257389,
        "dist_mmd2": 0.04147082046650852,
        "dist_mean_l2": 0.6841046787905218
      },
      {
        "iter": 3.0,
        "td_loss": 5.624717953239446e-05,
        "critic_teacher_error": 0.022382824503431615,
        "tracking_gap": 4.525294385014115e-11,
        "mean_rho2": 1.58484345445087,
        "w_norm": 1.5482549085920079,
        "fixed_point_gap": 0.020925476250861684,
        "fixed_point_drift": 0.017799565176327865,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999916150514712,
        "dist_mmd2": 0.03090334526633709,
        "dist_mean_l2": 0.5225390543686588
      },
      {
        "iter": 4.0,
        "td_loss": 0.00015153025060005368,
        "critic_teacher_error": 0.022380879557405173,
        "tracking_gap": 7.945832307083368e-11,
        "mean_rho2": 1.4799988696921667,
        "w_norm": 1.5482396713832387,
        "fixed_point_gap": 0.02160970248269506,
        "fixed_point_drift": 0.017212815664483072,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999917340651693,
        "dist_mmd2": 0.01805473992992601,
        "dist_mean_l2": 0.3204918767249825
      },
      {
        "iter": 5.0,
        "td_loss": 2.703796555427019e-05,
        "critic_teacher_error": 0.02238054352422918,
        "tracking_gap": 5.3726778887879306e-11,
        "mean_rho2": 1.5374346454156613,
        "w_norm": 1.548228445959295,
        "fixed_point_gap": 0.018573129806626783,
        "fixed_point_drift": 0.017962410142945532,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999921145767171,
        "dist_mmd2": 0.02432339867414368,
        "dist_mean_l2": 0.3736729653545262
      },
      {
        "iter": 6.0,
        "td_loss": 5.4404900857627044e-05,
        "critic_teacher_error": 0.02237927720435006,
        "tracking_gap": 5.136156269781545e-11,
        "mean_rho2": 1.5812966361790586,
        "w_norm": 1.5482151035866738,
        "fixed_point_gap": 0.0233060421998501,
        "fixed_point_drift": 0.018866189655030178,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999923076586249,
        "dist_mmd2": 0.027676102549147874,
        "dist_mean_l2": 0.49632567706937497
      },
      {
        "iter": 7.0,
        "td_loss": 8.23466270435367e-05,
        "critic_teacher_error": 0.022377953431216045,
        "tracking_gap": 6.381568606009765e-11,
        "mean_rho2": 1.6703710201030901,
        "w_norm": 1.5482158794631429,
        "fixed_point_gap": 0.029224662734367277,
        "fixed_point_drift": 0.02569435520355139,
        "fixed_point_drift_defined": 1.0,
        "stability_proxy": 0.9999917568193094,
        "dist_mmd2": 0.03615768433471522,
        "dist_mean_l2": 0.636098673202821
      }
    ]
  },
  "health_summary": {
    "status": "PASS",
    "reasons": [
      "all checks passed"
    ]
  },
  "recommendations": [
    "no major rule-based issues detected; consider longer runs or new probes if results are inconclusive."
  ],
  "incomplete": false,
  "exception": null
}